<!DOCTYPE html>
<html>

<head>

  <meta charset="UTF-8">

  <title>测试</title>

  <link rel="stylesheet" href="normalize.css">

  <link rel="stylesheet" href="style.css" media="screen" type="text/css" />

</head>

<body>

<canvas class="canvas"></canvas>

<div class="ui">
  <input class="ui-input" type="text" />
  <span class="ui-return">↵</span>
</div>
  <script src="index.js"></script>
 <audio style="display:none; height: 0" id="bg-music" preload="auto" src="test.mp3" loop="loop"></audio>
  <script>
        //音乐自动播放
        $(document).ready(function(){
            autoPlayMusic();
            audioAutoPlay();
        });
        function audioAutoPlay() {
            var audio = document.getElementById('bg-music');
            audio.play();
            document.addEventListener("WeixinJSBridgeReady", function () {
                audio.play();
            }, false);
        }
        // 音乐播放
        function autoPlayMusic() {
            // 自动播放音乐效果，解决浏览器或者APP自动播放问题
            function musicInBrowserHandler() {
                musicPlay(true);
                document.body.removeEventListener('touchstart', musicInBrowserHandler);
            }
            document.body.addEventListener('touchstart', musicInBrowserHandler);
            // 自动播放音乐效果，解决微信自动播放问题
            function musicInWeixinHandler() {
                musicPlay(true);
                document.addEventListener("WeixinJSBridgeReady", function () {
                    musicPlay(true);
                }, false);
                document.removeEventListener('DOMContentLoaded', musicInWeixinHandler);
            }
            document.addEventListener('DOMContentLoaded', musicInWeixinHandler);
        }
        function musicPlay(isPlay) {
            var media = document.querySelector('#bg-music');
            if (isPlay && media.paused) {
                media.play();
            }
            if (!isPlay && !media.paused) {
                media.pause();
            }
        }
    </script>
</body>

</html>
